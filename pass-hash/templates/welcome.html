<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Welcome!</title>
    <link rel="stylesheet" href="/static/style.css">
    <style>
        body { font-family: Arial, sans-serif; background: #f5f6fa; overflow-x: hidden; }
        .box { max-width: 400px; margin: 60px auto; padding: 30px; background: #fff; border-radius: 10px; box-shadow: 0 2px 8px #dcdde1; position: relative; z-index: 2; }
        h2 { text-align: center; color: #0097e6; }
        .info { text-align: center; margin-top: 15px; color: #353b48; font-size: 15px; }
        a { color: #0097e6; text-decoration: none; }
        .confetti { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: 1; }
    </style>
</head>
<body>
    <canvas class="confetti" id="confetti"></canvas>
    <div class="box">
        <h2>Welcome, {{ name }}!</h2>
        <div class="info">
            <p>You have successfully logged in.</p>
            <p>Enjoy the celebration!</p>
            <button onclick="document.getElementById('hashbox').style.display='block'" style="margin: 12px 0; padding: 8px 16px; border-radius: 6px; background: #0097e6; color: #fff; border: none; cursor: pointer;">Show my hashed password</button>
            <div id="hashbox" style="display:none; margin-top:10px; word-break:break-all; background:#f1f2f6; padding:10px; border-radius:6px; color:#273c75; font-size:14px;">{{ user_hash }}</div>
            <p><a href="/login">Logout</a></p>
        </div>
    </div>
    <script>
    function startCelebration() {
        const canvas = document.getElementById('confetti');
        const ctx = canvas.getContext('2d');
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // Confetti spray from bottom center
        const confettiColors = ['#e84118', '#0097e6', '#44bd32', '#fbc531', '#8c7ae6', '#00b894', '#fd79a8'];
        function randomColor() {
            return confettiColors[Math.floor(Math.random() * confettiColors.length)];
        }
        function ConfettiPaper() {
            // Pop from left and right with random trajectories
            const side = Math.floor(Math.random() * 2);
            if (side === 0) { // left
                this.x = 0;
                this.y = Math.random() * canvas.height;
                const angle = Math.PI * (0.1 + Math.random() * 0.6); // rightward arc
                const speed = Math.random() * 8 + 6;
                this.vx = Math.cos(angle) * speed;
                this.vy = Math.sin(angle) * speed;
            } else { // right
                this.x = canvas.width;
                this.y = Math.random() * canvas.height;
                const angle = Math.PI * (0.8 + Math.random() * 0.6); // leftward arc
                const speed = Math.random() * 8 + 6;
                this.vx = Math.cos(angle) * speed;
                this.vy = Math.sin(angle) * speed;
            }
            this.w = Math.random() * 28 + 18;
            this.h = Math.random() * 16 + 10;
            this.angle = Math.random() * Math.PI * 2;
            this.spin = (Math.random() - 0.5) * 0.12;
            this.gravity = 0.18 + Math.random() * 0.09;
            this.color = randomColor();
        }
    let confettiPapers = [];
    for (let i = 0; i < 60; i++) confettiPapers.push(new ConfettiPaper()); // left
    for (let i = 0; i < 40; i++) confettiPapers.push(new ConfettiPaper()); // right

        // Firecracker rockets
        function Rocket(x) {
            this.x = x;
            this.y = canvas.height + 10;
            this.vy = - (Math.random() * 10 + 18); // faster
            // Bright firecracker colors
            const fireColors = ['#fff200', '#ff3838', '#ffb347', '#ffec8b', '#ff6347', '#ff4500', '#ffd700', '#fff', '#ff0'];
            this.color = fireColors[Math.floor(Math.random() * fireColors.length)];
            this.burst = false;
            this.particles = [];
            this.trail = [];
        }
        function Particle(x, y, color) {
            this.x = x;
            this.y = y;
            this.r = Math.random() * 7 + 6;
            this.angle = Math.random() * Math.PI * 2;
            this.speed = Math.random() * 16 + 8;
            this.vx = Math.cos(this.angle) * this.speed;
            this.vy = Math.sin(this.angle) * this.speed;
            this.gravity = 0.22;
            this.color = color;
            this.alpha = 1;
        }
        let rockets = [];
        function launchRockets() {
            rockets = [];
            // Launch three rockets at a time, spaced evenly
            for (let i = 0; i < 3; i++) {
                let x = canvas.width * (0.2 + 0.3 * i);
                rockets.push(new Rocket(x));
            }
        }
        launchRockets();

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            // Confetti papers
            for (let paper of confettiPapers) {
                ctx.save();
                ctx.translate(paper.x, paper.y);
                ctx.rotate(paper.angle);
                ctx.fillStyle = paper.color;
                ctx.fillRect(-paper.w/2, -paper.h/2, paper.w, paper.h);
                ctx.restore();
                paper.x += paper.vx;
                paper.y += paper.vy;
                paper.vy += paper.gravity;
                paper.angle += paper.spin;
                // Reset if out of bounds
                if (paper.x < -40 || paper.x > canvas.width + 40 || paper.y > canvas.height + 40 || paper.y < -40) {
                    Object.assign(paper, new ConfettiPaper());
                }
            }
            // Firecracker rockets
            let allBurst = true;
            for (let rocket of rockets) {
                if (!rocket.burst) {
                    allBurst = false;
                    // Draw rocket body
                    ctx.save();
                    ctx.beginPath();
                    ctx.moveTo(rocket.x, rocket.y);
                    ctx.lineTo(rocket.x, rocket.y + 24);
                    ctx.strokeStyle = rocket.color;
                    ctx.lineWidth = 5;
                    ctx.stroke();
                    ctx.beginPath();
                    ctx.arc(rocket.x, rocket.y, 10, 0, Math.PI * 2);
                    ctx.fillStyle = rocket.color;
                    ctx.fill();
                    ctx.restore();
                    // Draw rocket trail
                    rocket.trail.push({x: rocket.x, y: rocket.y + 24, alpha: 0.7});
                    for (let t of rocket.trail) {
                        ctx.save();
                        ctx.globalAlpha = t.alpha;
                        ctx.beginPath();
                        ctx.arc(t.x, t.y, 6, 0, Math.PI * 2);
                        ctx.fillStyle = '#fff';
                        ctx.fill();
                        ctx.restore();
                        t.alpha -= 0.04;
                    }
                    rocket.trail = rocket.trail.filter(t => t.alpha > 0.05);
                    rocket.y += rocket.vy;
                    rocket.vy += 0.09; // less gravity
                    if (rocket.y < 10) { // burst at very top
                        rocket.burst = true;
                        for (let j = 0; j < 100; j++) {
                            // Bright burst colors
                            const burstColors = ['#fff200', '#ff3838', '#ffb347', '#ffec8b', '#ff6347', '#ff4500', '#ffd700', '#fff', '#ff0'];
                            rocket.particles.push(new Particle(rocket.x, rocket.y, burstColors[Math.floor(Math.random() * burstColors.length)]));
                        }
                    }
                } else {
                    for (let p of rocket.particles) {
                        ctx.save();
                        ctx.globalAlpha = p.alpha;
                        ctx.beginPath();
                        ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
                        ctx.fillStyle = p.color;
                        ctx.fill();
                        ctx.restore();
                        p.x += p.vx;
                        p.y += p.vy;
                        p.vy += p.gravity;
                        p.alpha -= 0.009;
                    }
                    rocket.particles = rocket.particles.filter(p => p.alpha > 0.05);
                }
            }
            // When all rockets have burst and faded, relaunch three new rockets
            if (allBurst && rockets.every(r => r.particles.length === 0)) {
                launchRockets();
            }
            requestAnimationFrame(animate);
        }
        animate();
    }
    window.addEventListener('DOMContentLoaded', startCelebration);
    </script>
</body>
</html>
